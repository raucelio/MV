[
["intro.html", "Missing value: uma apostila. Capítulo 1 Introdução 1.1 Missing no R 1.2 Conceitos de MCAR, MAR e MNAR", " Missing value: uma apostila. Inferir Estatística 2020-10-13 Capítulo 1 Introdução Missing Values (ou valores ausentes) é um fenômeno gerado pela falta de um valor em uma variável para uma observação. 1.1 Missing no R No R, quando um elemento, valor, não está disponível, a sua posição no vetor é assinalada por NA. Exemplo: &gt; a &lt;- c(1, 2, 3, NA) &gt; b &lt;- c(&#39;a&#39;, NA, &#39;C&#39;) &gt; c &lt;- c(FALSE, TRUE, NA) Um elemento resultante de uma indeterminação matemática é assinalado por NaN. &gt; a &lt;- c(4, 5, 8, 0)/0 &gt; a [1] Inf Inf Inf NaN A função is.na(x) retorna um vetor do mesmos tamanho do vetor x, com valor TRUE na mesma posição onde se encontra um NA. &gt; a &lt;- c(4, NA, 8, NA) &gt; is.na(a) [1] FALSE TRUE FALSE TRUE A função is.nan(x) retorna um vetor do mesmos tamanho do vetor x, com valor TRUE na mesma posição onde se encontra um NaN. No exemplo seguinte, observa-se que is.na(x) retorna TRUE quando encontra um NaN. a &lt;- c(Inf-Inf, 0/0, NA, NaN) is.nan(a) [1] TRUE TRUE FALSE TRUE is.na(a) [1] TRUE TRUE TRUE TRUE 1.1.1 Como o R trata missing value Quando há um Naenvolvido em uma operação, o resultado é um NA. Isto ocorre, porque os dados envolvidos não estão definidos. &gt; a &lt;- c(1,2,3,NA) &gt; mean(a) [1] NA &gt; 5 + NA [1] NA Em muitas funções do R há o arumento na.rm=, que recebe um valor lógico TRUE ou FALSE, se for atribuído o valor TRUE os elemetos NA não são considerados. &gt; a &lt;- c(1,2,3,NA) &gt; mean(a) [1] NA &gt; mean(a, na.rm = TRUE) [1] 2 Em uma operação relacional ==, &gt;, &gt;=, &lt; , &lt;= ou !=, quando um dos operandos é NA, o resultado é um NA. Assim, para verificar se um valor x é NA não use x == NA, use is.na(x). Há análises no R que só atuam em um conjunto de dados completos, logo exitindo, ao menos um, NA na observação, essa é excluída da análise. Observe o resultado da análise de regressão. Na análise de regressão, abaixo, das 153 observações, 37 foram eleiminadas porque apresentavam NA na variável dependente Ozone. # As observações com NA em Ozone e Wind são eliminadas # da análise. &gt; fit &lt;- lm(Ozone ~ Wind, data = airquality) &gt; summary(fit) Call: lm(formula = Ozone ~ Wind, data = airquality) Residuals: Min 1Q Median 3Q Max -51.572 -18.854 -4.868 15.234 90.000 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 96.8729 7.2387 13.38 &lt; 2e-16 *** Wind -5.5509 0.6904 -8.04 9.27e-13 *** --- Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Residual standard error: 26.47 on 114 degrees of freedom (37 observations deleted due to missingness) Multiple R-squared: 0.3619, Adjusted R-squared: 0.3563 F-statistic: 64.64 on 1 and 114 DF, p-value: 9.272e-13 1.2 Conceitos de MCAR, MAR e MNAR Rubin (1976) classificou os problemas de dados perdidos em três categorias. Em sua teoria, cada ponto de dados tem alguma probabilidade de ser ausente. O processo que governa essas probabilidades é chamado de missing data mechanism or response mechanism. Os processo apresentados são: MCAR (missing completely at random) MAR (missing at random) MNAR (missing not at random) 1.2.1 MCAR O processo MCAR ocorre se a probabilidade de ocorrer um missing value é a mesma para todos os casos. Isso implica efetivamente que as causas dos missing values não estão relacionadas aos dados. Consequentemente, podemos ignorar muitas das complexidades que surgem devido à falta de dados, além da óbvia perda de informações. Exemplo de MCAR Uma balança que ficou sem baterias, alguns dados serão perdidos simplesmente por falta de sorte. Em uma amostra aleatória, onde cada membro tem a mesma chance de ser incluído na amostra. Os dados (não observados) de membros da população. Embora seja conveniente, o MCAR geralmente não é realista para os dados disponíveis. 1.2.2 MAR O processo MAR ocorre a probabilidade de ser missing values é a mesma apenas dentro de grupos definidos por dados observados. MAR é uma classe muito mais ampla do que MCAR. Por exemplo, Uma balanças colocada em uma superfície macia pode, produzir mais missing values do que quando colocada em uma superfície rígida. Se, entretanto, sabemos o tipo de superfície e se podemos assumir MCAR dentro do tipo de superfície, então os dados são MAR. Ao tomar uma amostra de uma população, onde a probabilidade de ser incluída depende de alguma propriedade conhecida. MAR é mais geral e mais realista do que MCAR. Os métodos modernos de dados perdidos geralmente partem do pressuposto MAR. 1.2.3 MNAR O processco MNAR ocorre se os processos MCAR e MAR não forem válidos. MNAR significa que a probabilidade de estar perdido varia por motivos que desconhecemos. Por exemplo: O mecanismo da balança de pesagem pode se desgastar ao longo do tempo, produzindo mais dados perdidos conforme o tempo passa, mas podemos deixar de notar isso. Se os objetos mais pesados forem medidos posteriormente, obteremos uma distribuição das medições que será distorcida. MNAR inclui a possibilidade de que a escala produza mais valores ausentes para os objetos mais pesados , uma situação que pode ser difícil de reconhecer e controlar. Um exemplo de MNAR em pesquisas de opinião pública ocorre se aqueles com opiniões mais fracas respondem com menos frequência. MNAR é o caso mais complexo. As estratégias para lidar com o MNAR são encontrar mais dados sobre as causas da falta ou realizar análises hipotéticas para ver o quão sensíveis são os resultados em vários cenários. A distinção de Rubin é importante para entender por que alguns métodos não funcionam. Sua teoria estabelece as condições sob as quais um método de dados ausentes pode fornecer inferências estatísticas válidas. A maioria das correções simples funciona apenas sob a suposição MCAR restritiva e freqüentemente irreal. Se MCAR for implausível, tais métodos podem fornecer estimativas viesadas. "],
["métodos-básicos-de-imputação.html", "Capítulo 2 Métodos Básicos de Imputação 2.1 Métodos Básicos", " Capítulo 2 Métodos Básicos de Imputação 2.1 Métodos Básicos 2.1.1 Listwise deletion Listwise deletion consiste em eliminar toda observação que apresente NA em uma de suas variáveis, é o comportamento padrão de lidar missing values em muitos pacotes estatísticos. A função na.omit () faz o R assumir esse comportamento, pois exclui do data frame toda observação com ‘NA’ em ao menos uma de suas variáveis. A principal vantagem listwise deletion é a conveniência, se os dados forem MCAR, essa abordagem produz estimativas não viesadas para médias, variâncias e coeficeintes de uma regressão. No MCAR, a listwise deletion produz erros padrão e níveis de significância que são corretos para o subconjunto reduzido de dados, mas que geralmente são maiores em relação a todos os dados disponíveis. Uma desvantagem da listwise deletion é a potencial perda de observações. Não é incomum em aplicações reais que mais da metade da amostra original seja perdida, especialmente se o número de variáveis for grande. Uma subamostra menor pode dificultar a capacidade de detectar os efeitos de interesse. Se os dados não forem MCAR, a *listwise deletio pode viesar as estimativas de médias, coeficientes de regressão e correlações. No entanto, a listwise deletion nem sempre é ruim. As implicações dos dados ausentes são diferentes dependendo de onde eles ocorrem (resultados ou preditores) e do parâmetro e forma do modelo da análise completa dos dados. No contexto da análise de regressão, a listwise deletion o possui algumas propriedades exclusivas que a tornam atraente em ambientes específicos. Há casos em que a exclusão listwise pode fornecer estimativas melhores do que até mesmo os procedimentos mais sofisticados. A Listwise deletio pode introduzir inconsistências nos relatórios de uma pesquisa. Uma vez que a listwise deletion é aplicada automaticamente ao conjunto ativo de variáveis, análises diferentes nos mesmos dados são freqüentemente baseadas em diferentes subamostras. É possível produzir uma subamostra global usando todas as variáveis ativas. Na prática, isso pode gerar problemas, pois a subamostra global sempre terá menos casos do que cada uma das subamostras, portanto, é comum criar subconjuntos diferentes para tabelas diferentes. Isso complica sua comparação e generalização para a população de estudo. Em alguns casos, a listwise deletion pode levar a subamostras sem sentido. Por exemplo, as observações no dataset airquality correspondem a 154 dias consecutivos entre 1º de maio de 1973 e 30 de setembro de 1973. A exclusão de dias afeta a base de tempo. Seria muito mais difícil, senão impossível, realizar análises que envolvam tempo, por exemplo, para identificar padrões semanais ou ajustar modelos autorregressivos que preveem de dias anteriores. 2.1.2 Pairwise deletion A pairwise deletions, também conhecida como análise de caso disponível, tenta remediar o problema de perda de observações que ocorrem na listwise deletion. O método calcula as médias e (co) variâncias para todos os dados observados disponíveis. Assim, a média da variável X é baseada em todos os casos com dados observados em X, a média da variável Y usa todos os casos com valores de Y observados. Para a correlação e covariância, todos os dados são considerados nos quais X e Y não são NA. Posteriormente, a matriz é alimentada em um programa para análise de regressão, análise fatorial ou outros procedimentos de modelagem. Podemos calcular a média, covariâncias e correlações dos dados de qualidade aérea sob exclusão de pares em R como: mean(airquality, na.rm = TRUE) cor(airquality, use = “pair”) cov(airquality, use = “pair”) O método é simples, usa todas as informações disponíveis e produz estimativas consistentes de média, correlações e covariâncias sob MCAR . No entanto, quando consideradas em conjunto, essas estimativas apresentam deficiências importantes. As estimativas podem ser tendenciosas se os dados não forem MCAR. Além disso, existem problemas computacionais. A matriz de correlação pode não ser definida positivamente, o que é um requisito para a maioria procedimentos multivariados. Podem ocorrer correlações fora do intervalo [-1, + 1], um problema que vem de diferentes subconjuntos usados para as covariâncias e as variâncias. Esses problemas são mais graves para variáveis altamente correlacionadas . Outro problema é que não está claro qual tamanho de amostra deve ser usado para calcular os erros padrão. Tirar o tamanho médio da amostra resulta em erros padrão que são muito pequenos . A ideia por trás da exclusão aos pares é usar todas as informações disponíveis. Embora essa ideia seja boa, a análise adequada da matriz de pares requer técnicas sofisticadas de otimização e fórmulas especiais para calcular os erros padrão . 2.1.3 Mean imputation A mean imputation é substituir o NA em uma variável pela média dos valores observados. No caso da variável ser categórica, o valor NA pode ser substituído pela moda. Uma solução rápida para os dados ausentes é substituí-los pela média. Podemos usar a moda para dados categóricos. O pacote R mice (Van Buuren e Groothuis-Oudshoorn, 2011) implementa a mean imputation . Seja o dataset airquality, para imputar a média nas variáveis Ozone e Solar.R pode ser feito por library(mice) ## Warning: package &#39;mice&#39; was built under R version 3.6.3 ## ## Attaching package: &#39;mice&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## cbind, rbind imp &lt;- mice(airquality, method = &quot;mean&quot;, m = 1, maxit = 1) ## ## iter imp variable ## 1 1 Ozone Solar.R onde method = “mean” - especifica a imputação média; m = 1 solicita um único conjunto de dados imputado; e maxit = 1 define o número de iterações para 1 (sem iteração). A imputação média distorce a distribuição de várias maneiras. A Figura 1.1 mostra a distribuição da Ozone após a imputação. library(ggplot2) dados_observados &lt;- data.frame(observado = na.omit(airquality$Ozone)) dados_imputados &lt;- data.frame(imputado = imp$imp$Ozone) ggplot()+ geom_histogram(data = dados_observados, aes(x=observado), bins = 15, fill=&quot;blue&quot;, alpha = 0.5)+ geom_histogram(data = dados_imputados, aes(x=X1), bins = 15, fill = &quot;red&quot;, alpha = 0.5)+ labs(x = &quot;Valores da variável Ozone&quot;, y = &quot;Frequência&quot;) Figure 2.1: Dados Observados e imputados A cor azul refere-se aos dados observados , vermelho aos dados imputados (também chamados de valores sintéticos ou imputações). A cor preta, aos dados completos, e também chamados de imputados. Na figura, a barra vermelha na média se destaca. Imputar a média criou uma distribuição bimodal. O desvio padrão nos dados completos é igual a 28.7, menor do que os dados observados, que é 33. A figura do lado direito mostra que a relação entre Ozônio e Solar.R é distorcida por causa das imputações. A correlação cai de 0,35 nos pontos azuis para 0,3 nos dados combinados. library(ggplot2) dados &lt;- na.omit(airquality[,c(&quot;Ozone&quot;, &quot;Solar.R&quot;)]) dados_observados &lt;- data.frame(dados) dados_ausentes &lt;- airquality [is.na(airquality$Ozone) | is.na(airquality$Solar.R), c(&quot;Ozone&quot;, &quot;Solar.R&quot;) ] Ozone_imputado &lt;- ifelse (is.na(dados_ausentes$Ozone), mean(dados_observados$Ozone), dados_ausentes$Ozone) Solar.R_imputado &lt;- ifelse (is.na(dados_ausentes$Solar.R), mean(dados_observados$Solar.R), dados_ausentes$Solar.R) dados_imputados &lt;- data.frame(Ozone = Ozone_imputado, Solar.R = Solar.R_imputado) ggplot()+ geom_point(data = dados_observados, aes(y=Ozone, x=Solar.R), color=&quot;blue&quot;, alpha = 0.5)+ geom_point(data = dados_imputados, aes(y=Ozone, x = Solar.R), color = &quot;red&quot;, alpha = 0.5)+ labs(y = &quot;Variável Ozone&quot;, x = &quot;Variável Solar.R&quot;) Figure 2.2: Relação entre Ozone e Solar.R A imputação média é uma solução rápida e simples para os missing values. No entanto, subestima a variância, altera as relações entre as variáveis, enviesar quase qualquer estimativa diferente da média e enviesar a estimativa da média quando os dados não são MCAR. A imputação média talvez deva ser usada apenas como uma correção rápida quando um punhado de valores está faltando, e deve ser evitada em geral. 2.1.4 Regression imputation A Regression imputation incorpora o conhecimento de outras variáveis com a ideia de produzir imputações mais inteligentes. A primeira etapa envolve a construção de um modelo a partir dos dados observados. As previsões para os casos incompletos são então calculadas de acordo com o modelo ajustado e servem como substitutos para os dados ausentes. Suponha que modelamos Ozone pela função de regressão linear de Solar.R. fit &lt;- lm (Ozone ~ Solar.R, data = airquality) pred &lt;- predict (fit, newdata = ic (airquality)) pred &lt;- data.frame (Ozone_imputado=pred, ic(airquality) ) pred &lt;- pred[!is.na(Ozone_imputado), ] dados &lt;- na.omit(airquality[,c(&quot;Ozone&quot;, &quot;Solar.R&quot;)]) dados_observados &lt;- data.frame(dados) Ozone_imputado &lt;- pred ggplot()+ geom_point(data = dados_observados, aes(y=Ozone, x=Solar.R), color=&quot;blue&quot;, alpha = 0.5)+ geom_point(data = Ozone_imputado, aes(y=Ozone_imputado , x = Solar.R), color = &quot;red&quot;, alpha = 0.5)+ labs(y = &quot;Variável Ozone&quot;, x = &quot;Variável Solar.R&quot;) Figure 2.3: Regression imputation entre Ozone e Solar.R Os valores imputados correspondem aos valores mais prováveis pelo modelo. No entanto, o conjunto de valores imputados variam menos do que os valores observados.. A Regression imputation também afeta a correlação, os pontos vermelhos têm uma correlação de 1, pois estão localizados em uma linha. Se os pontos vermelhos e azuis forem combinados, a correlação aumenta de 0.35 para 0.39. A Regression imputation produz estimativas não viesadas das médias sob MCAR, assim como a imputação da média, e dos pesos de regressão do modelo de imputação se as variáveis explicativas forem completas. Além disso, os coeficientes da regressão são não viesados sob MAR se os fatores que influenciam a falta fazem parte do modelo de regressão. No exemplo, isso corresponde à situação em que Solar.R explicaria quaisquer diferenças na probabilidade de falta de ozônio. Por outro lado, a variabilidade dos dados imputados é sistematicamente subestimada. A imputação de valores preditos pode produzir imputações realistas se a predição estiver próxima da perfeição. Nesse caso, o método reconstrói as partes que faltam a partir dos dados disponíveis. "],
["métodos-básicos-de-imputação-ii.html", "Capítulo 3 Métodos Básicos de Imputação - II 3.1 Métodos Básicos II", " Capítulo 3 Métodos Básicos de Imputação - II 3.1 Métodos Básicos II 3.1.1 Stochastic regression inputation A imputação de regressão estocástica é um refinamento da imputação de regressão que adiciona ruído às previsões. Isso terá um efeito descendente na correlação. Podemos imputar o ozônio por imputação de regressão estocástica como: imp &lt;- mice (airquality [, 1: 2], method = &quot;norm.nob&quot;, m = 1, maxit = 1, seed = 1) ## ## iter imp variable ## 1 1 Ozone Solar.R O argumento method = “norm.nob” requer um método de regressão estocástica simples, não bayesiana. Este método primeiro estima a interceptação, a inclinação e a variância residual sob o modelo linear e, em seguida, gera o valor imputado de acordo com essas especificações. Voltaremos aos detalhes na Seção 3.2. O argumento da semente torna a solução reproduzível. A Figura 1.3 mostra os resultados. A adição de ruído às previsões abre a distribuição dos valores imputados, conforme pretendido. Observe que algumas novas complexidades surgem. Existem várias imputações com valores negativos. Esses valores são implausíveis, uma vez que não existem concentrações negativas de ozônio no mundo real. Além disso, o limite superior da distribuição não é bem coberto. A causa disso é que a relação nos dados observados é um tanto heterocedástica. A variabilidade do ozônio parece aumentar até o nível de radiação solar de 250 langleys, e diminui depois disso. Embora seja Figura 1.4: Imputação de ozônio pela última observação realizada (LOCF). não está claro se este é um fenômeno meteorológico genuíno, o modelo de imputação não levou em consideração esse recurso. A imputação de regressão estocástica é um passo importante à frente. Em particular, preserva não só os pesos da regressão, mas também a correlação entre as variáveis (cf. Exercício 3). A imputação de regressão estocástica não resolve todos os problemas e há muitas sutilezas que precisam ser abordadas. No entanto, a ideia principal de retirar os resíduos é muito poderosa e forma a base de técnicas de imputação mais avançadas. 3.1.2 LOCF e BOCF A última observação realizada (LOCF) e a observação da linha de base realizada (BOCF) requerem dados longitudinais. A ideia é tomar o último valor observado como um substituto para os dados ausentes. A Figura 1.4 ilustra o método aplicado aos primeiros 80 dias da série do Ozônio. Os trechos de pontos vermelhos indicam as imputações. LOCF é conveniente porque gera um conjunto de dados completo. O método é usado em ensaios clínicos. A Food and Drug Administration (FDA) dos EUA tem tradicionalmente visto LOCF como o método de análise preferido, considerando-o conservador e menos sujeito à seleção do que à exclusão por lista. No entanto, Molenberghs e Kenward (2007, pp. 47-50) mostram que o viés pode operar em ambas as direções, e que LOCF pode produzir estimativas enviesadas mesmo sob MCAR. LOCF precisa ser seguido por um método de análise estatística adequado que distingue entre os dados reais e imputados. Isso normalmente não é feito, no entanto. Preocupações adicionais sobre uma reversão da direção do tempo são fornecidas em Kenward e Molenberghs (2009). O Painel sobre Tratamento de Dados Perdidos em Ensaios Clínicos recomenda que LOCF e BOCF não sejam usados ​​como a abordagem primária para lidar com dados ausentes, a menos que as suposições que os sustentam sejam cientificamente justificadas (National Research Council, 2010, p. 77). 3.1.3 Indicator method Suponha que desejemos ajustar uma regressão, mas há valores ausentes em uma das variáveis ​​explicativas. O método do indicador (Miettinen, 1985, p. 232) substitui cada valor ausente por um zero e estende o modelo de regressão pelo indicador de resposta. O procedimento é aplicado a cada variável incompleta. O usuário analisa o modelo estendido em vez do original. Este método é popular em saúde pública e epidemiologia. Uma vantagem é que o método do indicador retém o conjunto de dados completo. Além disso, permite diferenças sistemáticas entre os dados observados e não observados pela inclusão do indicador de resposta. No entanto, o método pode produzir estimativas de regressão severamente enviesadas, mesmo sob MCAR e para pequenas quantidades de dados ausentes (Vach e Blettner, 1991; Greenland e Finkle, 1995; Knol et al., 2010). Por outro lado, White e Thompson (2005) apontam que o método pode ser útil para estimar o efeito do tratamento em ensaios randomizados quando uma covariável de linha de base é parcialmente observada. Se os dados ausentes forem restritos à covariável, se o interesse for exclusivamente restrito à estimativa do efeito do tratamento, se a conformidade com o tratamento alocado for perfeita e se o modelo for linear sem interações, então o uso do método do indicador para essa covariável resulta em um estimativa não enviesada do efeito do tratamento. Isso é verdade mesmo se a falta depender da própria covariável. As condições sob as quais o método do indicador funciona são freqüentemente difíceis de alcançar na prática. O método não permite a perda de dados nos resultados, os quais ocorrem com frequência em dados reais. Embora o método do indicador possa ser adequado em alguns casos especiais, ele é insuficiente como uma forma geral de tratar dados ausentes. 3.1.4 Resumo A Tabela 1.1 fornece um resumo dos métodos discutidos nesta seção. A tabela aborda dois tópicos: se o método produz os resultados corretos em média (imparcialidade) e se produz o erro padrão correto. A imparcialidade é avaliada em relação à média, ao peso da regressão (da regressão com a variável incompleta como dependente) e à correlação. A tabela identifica as suposições sobre o mecanismo de dados perdidos que cada método deve fazer para produzir estimativas imparciais. Ambos os métodos de exclusão sempre requerem MCAR. Além disso, para exclusão listwise, há dois casos especiais MNAR (cf. Seção 2.6). A imputação de regressão e a imputação de regressão estocástica podem gerar estimativas não enviesadas sob MAR. Para funcionar, o modelo precisa ser especificado corretamente. LOCF e o método do indicador são incapazes de fornecer estimativas consistentes, mesmo sob MCAR. A exclusão listwise produz erros padrão que são corretos para o subconjunto de casos completos, mas em geral são muito grandes para todo o conjunto de dados. O cálculo dos erros padrão na exclusão de pares é complicado. Os erros padrão após a imputação são muito pequenos, uma vez que os cálculos padrão não fazem distinção entre os dados observados e os dados imputados. Fatores de correção para algumas situações foram desenvolvidos (Schafer e Schenker, 2000), mas uma solução mais conveniente é a imputação múltipla. "],
["references.html", "References", " References "]
]
